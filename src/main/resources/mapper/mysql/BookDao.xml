<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- Daoとxmlのマッピング -->
<mapper namespace="com.example.demo.dao.BookDao">

	<!-- 1件検索 -->
	<select id="findById" resultType="com.example.demo.entity.Book">
		SELECT
		id,
		book_name,
		volume_num,
		author_name
		FROM
		booktable
		WHERE
		id = #{id}
	</select>

	<!-- 全件検索 -->
	<select id="findAll" resultType="com.example.demo.entity.Book">
		SELECT
		id,
		book_name,
		volume_num,
		author_name,
		register_date
		FROM
		booktable
	</select>

	<!-- ユーザー1件登録 -->
	<insert id="insertOne">
		INSERT INTO booktable(
		book_name,
		volume_num,
		author_name
		)
		VALUES(
		#{bookName},
		#{volumeNum},
		#{authorName}
		)
	</insert>
	
	<!-- 1件検索（詳細） -->
	<select id="findByIdDetail" resultType="com.example.demo.entity.Book">
		SELECT
		booktable.id,
		booktable.book_name,
		booktable.volume_num,
		booktable.author_name,
		booktable.register_date,
		reading_status.reading_page,
		reading_status.update_date
		FROM
		booktable
		LEFT JOIN reading_status
		ON
		booktable.id = reading_status.id
		WHERE
		booktable.id = #{id}
	</select>
	
	<update id="updateOne">
		UPDATE
			reading_status
		SET
			reading_page = #{readingPage},
			update_date = CURRENT_DATE
		WHERE
		 	 id = #{id}
	</update>
</mapper>